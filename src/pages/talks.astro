---
import Centered from '@/layouts/Centered.astro';
import Breadcrumbs from '@/components/Breadcrumbs.astro';
import { BreadcrumbItemHome } from '@/constants/breadcrumb';
import talks from '@/constants/talks';
import { getPageMetadata } from '@/utils/metadata';

const sortedTalksKeys = Object.keys(talks).reverse();
const metadata = getPageMetadata('lists/talks');
const breadcrumbs = [BreadcrumbItemHome];
---

<Centered {metadata}>
  <article class="flex flex-col">
    <Breadcrumbs items={breadcrumbs} />
    <slot name="heading">
      <h1 class="b-h1">{metadata.title}</h1>
    </slot>
    <section class="flex flex-grow flex-col">
      <p>
        Do you want to invite me to talk in your event?
        <a
          href="https://github.com/mazipan/talks"
          target="blank"
          rel="noopener noreferrer"
          class="text-red-500"
        >
          &nbsp;Read this document.
        </a>
      </p>
      <br />
      {
        sortedTalksKeys.map((year, index) => (
          <details class="talk-year" open={index === 0}>
            <summary class="cursor-pointer p-2 text-xl font-bold leading-tight tracking-tight md:text-2xl md:tracking-tighter">
              {/*
                @ts-ignore */}
              {year} ({talks[year].length} talks)
            </summary>
            <div class="py-4">
              {/* @ts-ignore */}
              {talks[year].map((item) => {
                return (
                  <div class="mb-2 overflow-hidden rounded-lg border-2 border-base-300 bg-white p-4 dark:bg-base-100">
                    <div class="inline-block rounded-sm bg-gray-300 px-3 py-1 text-xs font-semibold dark:bg-gray-700">
                      <span class="mr-2">üóì </span>
                      <span>{item.date}</span>
                    </div>
                    <div class="mb-4 mt-4 text-lg font-bold md:text-xl">{item.event}</div>
                    <div class="md:text-md mb-4 text-sm">{item.topic}</div>

                    {item.link && item.link.length > 0 && (
                      <div class="flex text-sm">
                        {item.link.map((link: string) => (
                          <a
                            class="mr-4 rounded border-2 border-yellow-400 bg-yellow-400 px-2 py-1 font-bold text-black"
                            href={link}
                            target="blank"
                            rel="noopener noreferrer"
                          >
                            <span class="mr-2">‚ñ∂Ô∏è </span>
                            <span>Watch Video</span>
                          </a>
                        ))}

                        {item.slide && item.slide !== 'NOT_AVAILABLE' && (
                          <a
                            class="rounded border-2 border-yellow-400 px-2 py-1 font-bold text-yellow-400"
                            href={item.slide}
                            target="blank"
                            rel="noopener noreferrer"
                          >
                            <span class="mr-2">üñ•Ô∏è </span>View Slides
                          </a>
                        )}
                      </div>
                    )}
                  </div>
                );
              })}
            </div>
          </details>
        ))
      }
    </section>
  </article>
</Centered>
